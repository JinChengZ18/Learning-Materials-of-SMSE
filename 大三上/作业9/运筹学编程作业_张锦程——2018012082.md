<center><font size='7'>è¿ç­¹å­¦ç¼–ç¨‹ä½œä¸š<font/>



<center><font size='4'>å¼ é”¦ç¨‹&thinsp; æ84&thinsp; 2018012082<font/>



<center><font size='4'>ç¼–ç¨‹è¯­è¨€ï¼šPython&emsp; versionï¼š3.7.7&emsp; dateï¼š2020/10/18&emsp;<font/>


â€‹                     


---

##### ç›®å½•

[TOC]

##### ä¾‹é¢˜

è€ƒè™‘æ— çº¦æŸä¼˜åŒ–é—®é¢˜ $min\ ğ‘“(ğ‘¥_1, ğ‘¥_2) = (1 âˆ’ ğ‘¥_1)^2 + 2(ğ‘¥_2 âˆ’ ğ‘¥_1^2)^2$  ã€‚å–åˆå§‹ç‚¹ $ğ‘¥_0 = [0,0]^ğ‘‡$ï¼Œç”¨ MATLAB æˆ–è€… python ç¼–ç¨‹å®ç°ä»¥ä¸‹ 5 ç§ä¸‹é™ç®—æ³•æ±‚è§£ï¼ˆè¦æ±‚é‡‡ç”¨ç²¾ç¡®ç›´çº¿æœç´¢ï¼‰ï¼Œç»ˆæ­¢æ¡ä»¶ä¸º $â€–âˆ‡ğ‘“(ğ‘¥)â€–_2 â‰¤ 10^{âˆ’10}$ã€‚ç»™å‡ºæ¯ç§ç®—æ³•çš„æœ€ä¼˜è§£å’Œæœ€ä¼˜å€¼ï¼Œå¹¶ç”»å‡ºé‡‡ç”¨ä¸åŒç®—æ³•æ—¶å‡½æ•°å€¼éšè¿­ä»£æ¬¡æ•°å¢åŠ çš„å˜åŒ–æ›²çº¿ã€‚

è¦æ±‚ï¼šä»¥æ–‡ä»¶å‹ç¼©åŒ…æ–¹å¼æäº¤è¯¥é¢˜ï¼Œå‹ç¼©åŒ…ä¸­åº”å«æœ‰ç¨‹åºæºä»£ç ã€æ±‚è§£ç»“æœï¼ˆåŒ…æ‹¬æœ€ä¼˜è§£å’Œå‡½æ•°å˜åŒ–æ›²çº¿çš„åŸæ–‡ä»¶ï¼‰ä»¥åŠè¯´æ˜æ–‡æ¡£ï¼ˆPDFï¼‰ï¼Œå…¶ä¸­è¯´æ˜æ–‡æ¡£å†…å®¹ä¸ºç®€è¦è¯´æ˜æ¯ç§ç®—æ³•çš„æœ€ä¼˜å€¼ã€æœ€ä¼˜è§£ä»¥åŠå‡½æ•°å€¼å˜åŒ–æ›²çº¿ã€‚ 

ï¼ˆ1ï¼‰$ğ‘™_1$, $ğ‘™_2$, $ğ‘™_âˆ$ èŒƒæ•°æœ€é€Ÿä¸‹é™æ–¹æ³•ï¼› 

ï¼ˆ2ï¼‰ä¸¤ç§å…±è½­æ¢¯åº¦æ³•ï¼ˆFletcher-Reevesã€Polak-Ribiereï¼‰

##### 



##### æºç éƒ¨åˆ†ï¼š


```python
import matplotlib.tri as tri
import matplotlib.pyplot as plt
import matplotlib.cm as cm
import numpy as np
import time
import copy
```

å®šä¹‰å¾…ä¼˜åŒ–é—®é¢˜

```python
def function_z(x, y): # å¾…ä¼˜åŒ–çš„å‡½æ•°
    return (1-x)**2 + 2*(y-x**2)**2
def function_zsqrt(x, y):
    return ((1-x)**2 + 2*(y-x**2)**2)**0.25

def function_dz(x, y): # function_z çš„å¯¼æ•°çŸ©é˜µ, ä¹Ÿå¯ç”±scipyæ±‚å¯¼
    return np.array([-2+2*x+8*x**3-8*x*y, 4*y-4*x**2])
def function_d2z(x, y): # function_z çš„ Hessian å¯¼æ•°çŸ©é˜µ, ä¹Ÿå¯ç”±scipyæ±‚äºŒé˜¶å¯¼
    return np.array([[2+24*x**2-8*y, -8*x], [-8*x, 4]])
```



###### å®šä¹‰ä¸€ç»´ç²¾ç¡®æœç´ æ–¹æ³•

é‡‡ç”¨ç‰›é¡¿æ³•


```python
def newton_optimization(point0,Îµ,D): # point0ä¸ºåˆå§‹ç‚¹ï¼ŒÎµä¸ºæœç´¢ç²¾åº¦, Dä¸ºæœç´¢æ–¹å‘
    point=np.array(point0); D=np.array(D); t=1000
    while (t>Îµ) or (t<-Îµ) :
        f  = function_z(point[0],point[1])
        df = np.dot(function_dz(point[0],point[1]),D)
        d2f= np.dot(D, np.dot(function_d2z(point[0],point[1]),D.T))
        if df != 0:
            t = -df/d2f
            point = point + t*D
        else:
            return point
    return point
```



###### å®šä¹‰ l1 èŒƒæ•°ä¼˜åŒ–

 $l_1$ èŒƒæ•° $||D||_1=\sum\limits^n_{i=1}|d_i|$ ï¼š

$\hat{d_i}=\begin{cases}
sgn(-\frac{\part f(X)}{\part x_i})\ &if\ |\frac{\part f(X)}{\part x_i}|=||\nabla f(X)||_{\infty} \\
0 &if\ |\frac{\part f(X)}{\part x_i}|\neq||\nabla f(X)||_{\infty} \\
\end{cases}$


```python
def l1_optimization(point0): # point0 ä¸ºå¾…å¯»æ‰¾ä¼˜åŒ–æ–¹å‘çš„ç‚¹
    # ç»´æ•°
    dimension = len(point0)
    D = np.zeros(dimension)
    dz = function_dz(point0[0], point0[1])
    i  = np.argmax(abs(dz)) # é€‰å®šçš„ä¼˜åŒ–åæ ‡åºå·
    D[i]=-np.sign(dz[i])
    return D
```



###### å®šä¹‰ l2 èŒƒæ•°ä¼˜åŒ–

 $l_2$ èŒƒæ•° $||D||_1=\sqrt{\sum\limits^n_{i=1}|d_i|^2}$ ï¼š

$\hat{d_i}=sgn(-\frac{\part f(X)}{\part x_i})|\frac{\part f(X)}{\part x_i}|/(||\nabla f(X)||_q)$


```python
def f_length(A): # å‘é‡ A çš„é•¿åº¦
    length2 = 0
    for i in range(len(A)):
        length2 += A[i]**2
    return length2**0.5

def l2_optimization(point0): # point0 ä¸ºå¾…å¯»æ‰¾ä¼˜åŒ–æ–¹å‘çš„ç‚¹
    # ç»´æ•°
    dimension = len(point0)
    D = np.zeros(dimension)
    dz= function_dz(point0[0], point0[1])
    D = -dz/f_length(dz)
    return D
```



######  å®šä¹‰ lâˆ èŒƒæ•°ä¼˜åŒ–

å®šä¹‰ $l_\infty$ èŒƒæ•° $||D||_\infty=\max\limits_{1\leq i\leq n}|d_i|$ ä¼˜åŒ–ï¼š

$\hat{d_i}=sgn(-\frac{\part f(X)}{\part x_i}), \forall i$


```python
def linf_optimization(point0): # point0 ä¸ºå¾…å¯»æ‰¾ä¼˜åŒ–æ–¹å‘çš„ç‚¹
    # ç»´æ•°
    dimension = len(point0)
    D = np.zeros(dimension)
    dz= function_dz(point0[0], point0[1])
    for i in range(len(dz)):
        D[i] = -np.sign(dz[i])
    return D
```



###### Fletcher-Reeves & Polak-Ribiere å…±è½­æ¢¯åº¦æ³•

ä¸‹é¢å®ç° Fletcher-Reeves å’Œ Polak-Ribiere ä¸¤ç§å…±è½­æ¢¯åº¦æ³•ï¼š


```python
# Fletcher-Reeveså…±è½­æ¢¯åº¦æ³•, f_nablaä¸ºå…ˆå‰ä¸€æ­¥çš„æ¢¯åº¦ç»å¯¹å€¼,Diä¸ºå‰ä¸€æ­¥çš„ä¼˜åŒ–æ–¹å‘
def FR_optimization(point0,f_nabla,Di):
    dz= function_dz(point0[0], point0[1])
    Î± = f_length(dz)**2/f_nabla**2 # f_nablaä¸ºâˆæ—¶ï¼ŒÎ±ä¸º0
    D = -dz + Î±*Di
    print(Î±)
    return D
```


```python
# Polak-Ribiere å…±è½­æ¢¯åº¦æ³•,vec_nablaä¸ºå…ˆå‰ä¸€æ­¥çš„æ¢¯åº¦,Diä¸ºå‰ä¸€æ­¥çš„ä¼˜åŒ–æ–¹å‘
def PR_optimization(point0,vec_nabla,Di):
    dz= function_dz(point0[0], point0[1])
    Î± = np.dot(dz,dz-vec_nabla)/f_length(vec_nabla)**2
    D = -dz + Î±*Di
    print(Î±)
    return D
```



###### ç»˜å›¾å‡½æ•°

```python
def plot(name,f_values,f_nablas,f_points):
    min_d = -0.25; max_d = 1.25; n_d = 100

    x = np.linspace(min_d, max_d, n_d).flatten()
    y = np.linspace(min_d, max_d, n_d).flatten()
    X, Y = np.meshgrid(x, y)
    z = function_zsqrt(X, Y)

    plt.rcParams["figure.figsize"] = [22, 10]
    plt.rcParams["figure.dpi"] = 300
    plt.rcParams['font.size'] = '18' # è®¾ç½®å­—ä½“å¤§å° 
    plt.rcParams['lines.color'] = 'k'

    fig = plt.figure()
    grid = plt.GridSpec(8, 8, wspace=0.75, hspace=5)

    ax1=plt.subplot(grid[0:8,0:4]); ax2=plt.subplot(grid[0:4,4:8]); ax3=plt.subplot(grid[4:8,4:8])

    #ç”»ç­‰é«˜çº¿å›¾ ax1
    levels = np.arange(0., function_zsqrt(max_d+0.25, 0), 0.05)
    cmap = cm.get_cmap(name='coolwarm', lut=None)
    ax1.contourf(X,Y,z, levels=levels, cmap=cmap)
    ax1.contour(X,Y,z, levels=levels,
                  colors=['0.25', '0.75', '0.75', '0.75', '0.75'],
                  linewidths=[1.0, 0., 0., 0., 0.])
    ax1.set_xlabel(r'$x_1$'); ax1.set_ylabel(r'$x_2$')
    ax1.scatter([f_points[0][0]],[f_points[0][1]],color='',marker='o',edgecolors='r',s=100,label='Init Point')
    ax1.scatter([f_points[-1][0]],[f_points[-1][1]],color='',marker='o',edgecolors='b',s=100,label='End Point')
    
    ax1.text(min_d+0.05, min_d+0.1, r"$min\ f(ğ‘¥_1,ğ‘¥_2) = (1âˆ’ğ‘¥_1)^2 + 2(ğ‘¥_2âˆ’ğ‘¥_1^2)^2$", fontsize=20)   
    legend1 = ax1.legend(fancybox=False,edgecolor='k',loc=2); frame1=legend1.get_frame(); frame1.set_alpha(1); frame1.set_facecolor('none')
    ax1.spines['top'].set_linewidth('2.0');ax1.spines['left'].set_linewidth('2.0')
    ax1.spines['bottom'].set_linewidth('2.0');ax1.spines['right'].set_linewidth('2.0')
    
    # ç”»ç®­å¤´ä»¥è¡¨ç¤ºä¼˜åŒ–è¿‡ç¨‹
    for i in range(len(f_points)-1):
        ax1.arrow(f_points[i][0],f_points[i][1], f_points[i+1][0]-f_points[i][0], f_points[i+1][1]-f_points[i][1],
                    width=0.008/(i+1),length_includes_head=True,head_width=0.03/(i+1),head_length=0.08/(i+1),fc='r',ec='r')   
    
    # ç”»å‡½æ•°å€¼éšä¼˜åŒ–æ¬¡æ•°çš„å˜åŒ–æƒ…å†µ
    ax2.plot(list(range(len(f_values))), f_values, 'r', label=name+" optimization")
    ax2.set_xlabel('Iterations Times'); ax2.set_ylabel('Function Values')
    ax2.legend(framealpha=0)
    ax2.spines['top'].set_linewidth('2.0');ax2.spines['left'].set_linewidth('2.0')
    ax2.spines['bottom'].set_linewidth('2.0');ax2.spines['right'].set_linewidth('2.0')
    
    # ç”»æ¢¯åº¦ç»å¯¹å€¼éšä¼˜åŒ–æ¬¡æ•°çš„å˜åŒ–æƒ…å†µ
    ax3.plot(list(range(len(f_nablas))), f_nablas, 'r', label=name+" optimization")
    ax3.set_xlabel('Iterations Times'); ax3.set_ylabel('Gradient Absolute Values')
    ax3.legend(framealpha=0)
    ax3.spines['top'].set_linewidth('2.0');ax3.spines['left'].set_linewidth('2.0')
    ax3.spines['bottom'].set_linewidth('2.0');ax3.spines['right'].set_linewidth('2.0')
    
    plt.savefig(name+'è¿­ä»£æ¬¡æ•°-å‡½æ•°å€¼'+'.png')
    plt.show()
    
plot('ç¤ºä¾‹',[1,0.7,0.2,0],[1,0.5,0.1,0],[[0,0],[0.4,0],[0.88,0.5],[1,1]])
```

![png](output_14_1.png)



###### å®šä¹‰ä¼˜åŒ–è¿‡ç¨‹

ä¸‹é¢å¼€å§‹å®šä¹‰ä¼˜åŒ–è¿‡ç¨‹ï¼Œé»˜è®¤ä¼˜åŒ–ä» [0,0] å¼€å§‹ï¼š


```python
init_point = [0,0]

def main(init_point,method_name,Îµ=10**(-10)):   # method_nameä¸ºæ‰€ä½¿ç”¨çš„ä¼˜åŒ–æ–¹æ³•åç§°, init_pointä¸ºä¼˜åŒ–åˆå§‹ç‚¹
    time_start=time.time() # ç¨‹åºè®¡æ—¶
    point = init_point
    f_values = [function_z(point[0],point[1])]  # ä¼˜åŒ–è¿‡ç¨‹ä¸­æ‰€ç»å†çš„å‡½æ•°å€¼çš„é›†åˆ
    f_nablas = [f_length(function_dz(point[0],point[1]))] # ä¼˜åŒ–è¿‡ç¨‹ä¸­æ‰€ç»å†çš„æ¢¯åº¦ç»å¯¹å€¼çš„é›†åˆ
    f_points = [point]  # ä¼˜åŒ–è¿‡ç¨‹ä¸­æ‰€ç»å†çš„ç‚¹é›†
    t = float("inf"); f_nabla = float("inf"); Di = np.zeros(len(f_points)) # æ­¥é•¿å’Œæ¢¯åº¦å’Œä¼˜åŒ–æ–¹å‘
    while f_nabla>Îµ:
        if method_name=='l1':
            D=l1_optimization(point0=point)
        if method_name=='l2':
            D=l2_optimization(point0=point)
        if method_name=='lâˆ':
            D=linf_optimization(point0=point)
        if method_name=='FR':
            D=FR_optimization(point0=point,f_nabla=f_nablas[-1],Di=Di)
        if method_name=='PR':
            D=PR_optimization(point0=point,vec_nabla=function_dz(f_points[-1][0],f_points[-1][1]),Di=Di)
        Di=copy.deepcopy(D)
        point = newton_optimization(point0=point,Îµ=Îµ,D=D)
        f_nabla = f_length(function_dz(point[0],point[1]))
        
        f_values.append(function_z(point[0],point[1]))
        f_nablas.append(f_nabla)
        f_points.append(point)
        t = f_length(f_points[-1]-f_points[-2])
        
    time_end=time.time()
    print('æœ€ä¼˜è§£: '+str(f_points[-1])); print('æœ€ä¼˜å€¼: '+str(f_values[-1]))
    print('ä¼˜åŒ–ç”¨æ—¶: '+str(time_end-time_start)); print("\n\n\n")
    plot(method_name,f_values,f_nablas,f_points)     
    return point
```


```python
point_l1 = main(init_point,'l1',Îµ=10**(-10))
point_l2 = main(init_point,'l2',Îµ=10**(-10))
point_linf=main(init_point,'lâˆ',Îµ=10**(-10))
point_FR = main(init_point,'FR',Îµ=10**(-10))
point_PR = main(init_point,'PR',Îµ=10**(-10))
```



###### ä¼˜åŒ–ç»“æœ

$l_1$ èŒƒæ•°ä¼˜åŒ–

```
æœ€ä¼˜è§£: [1. 1.]
æœ€ä¼˜å€¼: 1.0892312857071719e-20
ä¼˜åŒ–ç”¨æ—¶: 0.029986143112182617
```

![png](output_17_2.png)

$l_2$ èŒƒæ•°ä¼˜åŒ–


    æœ€ä¼˜è§£: [1. 1.]
    æœ€ä¼˜å€¼: 1.0892367478700591e-20
    ä¼˜åŒ–ç”¨æ—¶: 0.03998136520385742


![png](output_17_4.png)

$l_2$ ä¼˜åŒ–çš„ç»“æœå’Œ $l_1$ åœ¨è¿™é‡Œæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œè¿™æ˜¯ç”±é—®é¢˜åˆå§‹æ¡ä»¶çš„ç‰¹æ®Šæ€§æ‰€å†³å®šçš„ï¼Œ$l_2$ æ¯æ¬¡çš„ä¼˜åŒ–æ–¹å‘å’Œä¸Šä¸€æ¬¡æ­£äº¤ï¼Œ$l_1$ æ¯æ¬¡çš„ä¼˜åŒ–æ–¹å‘åªæ²¿ç€åæ ‡è½´ï¼Œè€Œè¿™é‡Œç¬¬ä¸€æ¬¡çš„ä¼˜åŒ–æ–¹å‘å³ $[1,\ 0]$ æ‰€ä»¥å®ƒä»¬çš„å¯»ä¼˜è·¯çº¿ç›¸åŒã€‚



$l_\infty$ èŒƒæ•°ä¼˜åŒ–

```
æœ€ä¼˜è§£: [1. 1.]
æœ€ä¼˜å€¼: 9.46427809753135e-21
ä¼˜åŒ–ç”¨æ—¶: 0.037994384765625
```


![png](output_17_6.png)

Fletcher-Reeves å…±è½­æ¢¯åº¦æ³•

```
æœ€ä¼˜è§£: [1. 1.]
æœ€ä¼˜å€¼: 1.70317465220011e-21
ä¼˜åŒ–ç”¨æ—¶: 0.7503437995910645
```

![FRè¿­ä»£æ¬¡æ•°-å‡½æ•°å€¼](è¿ç­¹å­¦ç¼–ç¨‹ä½œä¸š_å¼ é”¦ç¨‹â€”â€”2018012082.assets/FRè¿­ä»£æ¬¡æ•°-å‡½æ•°å€¼-1605945218727.png)

Polak-Ribiere å…±è½­æ¢¯åº¦æ³•

```
æœ€ä¼˜è§£: [1. 1.]
æœ€ä¼˜å€¼: 4.965527361530408e-21
ä¼˜åŒ–ç”¨æ—¶: 0.1954784393310547
```

![PRè¿­ä»£æ¬¡æ•°-å‡½æ•°å€¼](è¿ç­¹å­¦ç¼–ç¨‹ä½œä¸š_å¼ é”¦ç¨‹â€”â€”2018012082.assets/PRè¿­ä»£æ¬¡æ•°-å‡½æ•°å€¼.png)

ä»ä¸Šå›¾çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¼˜åŒ–çš„å¼€å§‹é˜¶æ®µï¼ŒP-R æ³•å’Œæœ€é€Ÿä¸‹é™æ³•çš„å¯»ä¼˜è·¯å¾„ç›¸ä¼¼ï¼Œä½†æ˜¯ P-R æ³•åœ¨æ¥è¿‘æå°å€¼ç‚¹çš„åŒºåŸŸè¡¨ç°æ›´å¥½ï¼Œåªè¿­ä»£äº†ä¸åˆ° 100 æ¬¡ä¾¿æ”¶æ•›åˆ°äº†æœ€ä¼˜ç‚¹ï¼Œä½†æ˜¯è¿ç®—æ—¶é—´å¢å¤§äº† 4 å€ï¼›F-Ræ³•çš„è¡¨ç°ä¼¼ä¹ä¸ä½³ï¼Œåœ¨æå€¼ç‚¹é™„è¿‘æ”¶æ•›è·¯å¾„æˆä¸ºèºçº¿ï¼Œå¯èƒ½æ˜¯å‡½æ•°ä¸­å­˜åœ¨éç‚¹æ‰€è‡´ã€‚







